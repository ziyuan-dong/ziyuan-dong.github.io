<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="static/img/favicon.png" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>HMAC Generator</title>

    <!-- Vendor CSS Files -->
    <link 
      rel="stylesheet" 
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" 
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" 
      crossorigin="anonymous">

    <!-- Main CSS File -->
    <link href="static/css/encode.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <main class="container">
      <header>
        <h4 class="title">HMAC Generator</h4>
        <p class="note">Encoding: UTF-8</p>
    </header>
      
      <br>
      <form class="form">
        <div class="form-group">
          <label class="form-check-label" for="message">Message</label>
          <textarea rows="6" id="message" class="form-control"></textarea>
        </div>
        <div class="form-group">
          <label class="form-check-label" for="key">Key</label>
          <input type="text" id="key" class="form-control"></textarea>
        </div>
        <div class="btns">
          <button type="button" id="calculate" class="btn btn-primary">Calculate</button>
          <button type="reset" id="reset" class="btn btn-warning">Reset</button>
          <select class="custom-select" id="algorithms">
            <option selected value="md5">MD5</option>
            <option value="sha1">SHA1</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-check-label" for="result">Result</label>
          <input id="result" class="form-control" readonly />
        </div>
      </form>
    </main>

    <!-- Vendor JS Files -->
    <script 
      src="https://code.jquery.com/jquery-3.6.0.min.js" 
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" 
      crossorigin="anonymous"
    ></script>

    <script 
      src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" 
      integrity="sha512-E8QSvWZ0eCLGk4km3hxSsNmGWbLtSCSUcewDQPQWZF6pEU8GlT8a5fF32wOl1i8ftdMhssTrF/OhyGWwonTcXA==" 
      crossorigin="anonymous" 
      referrerpolicy="no-referrer">
    </script>

    <!--  Custom JS -->
    <script type="text/javascript">
      const message = $('#message');
      const key = $('#key');
      const result = $('#result');
      let method = CryptoJS.HmacMD5;

      $('#algorithms').change(() => {
        const algo = $('#algorithms option:selected');
        switch(algo) {
          case 'md5':
            method = CryptoJS.HmacMD5;
            break;
          case 'sha1':
            method = CryptoJS.HmacSHA1;
            break;
        }
      });

      $('#calculate').click(() => {
        const msgValue = message.val();
        const keyValue = key.val();
        const hashCode = method(msgValue, keyValue).toString();
        let formatedCode = hashCode.match(/.{1,4}/g).join(' ');
        result.val(formatedCode);
      });
    </script>

  </body>
</html>